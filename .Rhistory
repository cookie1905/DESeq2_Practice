theme(axis.title = element_text(size = 18), legend.text = element_text(size = 18)) + guides(colour = guide_legend(override.aes = list(size = 10)))
plot
library(ggplot2)
plot <- DimPlot(donor1, reduction = "umap", label = TRUE, label.size = 4.5) + xlab("UMAP 1") + ylab("UMAP 2") +
theme(axis.title = element_text(size = 5), legend.text = element_text(size = 5)) + guides(colour = guide_legend(override.aes = list(size = 8)))
plot
saveRDS(donor1, file = "donor1_final.rds")
# load necessary packages
library(dplyr)
library(Seurat)
library(patchwork)
# Set your working directory
setwd("C:\\scRNA_analysis_using_Seurat")
#checking if working directory is set correctly
getwd()
# SETUP THE SEURAT OBJECT
# loading dataset (cellranger ouput,  h5 file format)
donor1_data <- Read10X_h5("data/Donor1_filtered_feature_bc_matrix.h5")
# check the number of genes and cells before any filtering
# 33538  genes and 12185 cells
dim(donor1_data)
# What does data in a count matrix look like?
# Rows = genes
# Columns = cells
# Values = number of UMI counts (unique molecular identifiers) for that gene in that cell.
donor1_data[21000:21001, 1:3]
# Initialize the Seurat object with the raw (non-normalized data).
donor1 <- CreateSeuratObject(
counts = donor1_data,
project = "Donor1",
min.cells = 3,   # keep genes expressed in >= 3 cells
min.features = 200   # keeps only cells that have at least 200 unique genes detected.
)
donor1
# - 21851 features: Number of genes remaining after your filtering.
# - 12057 samples: Number of cells in your dataset after filtering.
# - Within 1 assay: Seurat organizes data into assays; by default this is RNA, which contains your raw (non-normalized) counts.
# - Active assay: The RNA assay is the currently active assay.
# - RNA (21851 features, 0 variable features): It has 21851 genes. 0 variable features means we haven’t yet selected highly variable genes (HVGs) for downstream analysis.
# - 1 layer present — counts: The assay has one layer, which is the raw count matrix. Layers in Seurat can also include normalized or scaled data if added later.
counts_matrix  <- GetAssayData(donor1[["RNA"]], layer = "counts")
# counts_matrix
counts_df <- as.data.frame(as.matrix(counts_matrix))
counts_df[1:5, 1:3]  # preview first 5 genes and 3 cells
# STANDARD PRE-PROCESSING WORKFLOW
# Quality Control and selecting cells for further analysis
# QC metrics commonly used include:
# 1. Number of unique genes detected = count of genes with ≥1 read/UMI
# 2. Total reads (or total UMIs) = all reads/UMIs in the cell
# 3. Percentage of reads that map to the mitochondrial genome
# meta.data stores cell-level metadata (one row per cell)
# nFeature_RNA stores unique genes/cells
# nCount_RNA stores total reads/cells
head(donor1@meta.data)
# Calculates the percentage of reads/UMIs from mitochondrial genes for each cell.
# Stores the result as a numeric column (percent.mt) in the Seurat object’s metadata.
# In human datasets, mitochondrial genes usually start with MT-.
# For mouse datasets, use mt- instead.
donor1[["percent.mt"]] <- PercentageFeatureSet(donor1, pattern = "^MT-")
head(donor1@meta.data)
# Visualize QC metrics as a violin plot
VlnPlot(donor1, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
plot1 <- FeatureScatter(donor1, feature1 = "nCount_RNA", feature2 = "percent.mt")
plot2 <- FeatureScatter(donor1, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")
plot1 + plot2
# filter cells that have unique feature counts over 8000 or less than 200
# filter cells that have >20% mitochondrial counts
donor1 <- subset(donor1, subset = nFeature_RNA > 200 & nFeature_RNA < 8000 & percent.mt < 20)
donor1
# Normalizing the data
# log1p( (counts / total counts per cell) * scale.factor )
donor1 <- NormalizeData(donor1, normalization.method = "LogNormalize", scale.factor = 10000)
# donor1[["RNA"]]$data
# Feature selection
# Identification of highly variable features (hvg's)
# features that are highly expressed in some cells, and lowly expressed in others.
# select 2000 highly variable genes
donor1 <- FindVariableFeatures(donor1, selection.method = "vst", nfeatures = 2000)
donor1 # has only 2000 genes which are highly variable across cells.
# Identify the 10 most highly variable genes
top10 <- head(VariableFeatures(donor1), 10)
top10
# Scaling the data
# Shifts the expression of each gene, so that the mean expression across cells is 0 and the variance across cells is 1.
# gives equal weight in downstream analyses, so that highly-expressed genes do not dominate
# By default, only variable features are scaled.
all.genes <- rownames(donor1)
donor1 <- ScaleData(donor1, features = all.genes)
# ‘regress out’ heterogeneity associated with (for example) cell cycle stage, or mitochondrial contamination
donor1 <- ScaleData(donor1, vars.to.regress = "percent.mt")
# Reduces dimensionality of the high-dimensional gene expression data
# PCA
donor1 <- RunPCA(donor1) # By default, RunPCA() uses only the highly variable genes (HVGs) as input for PCA.
# For each selected PC, we get genes with the highest positive and negative loadings.
# Loadings measure how much each gene contributes to that PC.
# Positive loading → gene expression correlates positively with the PC
# Negative loading → gene expression correlates negatively (anti-correlation)
VizDimLoadings(donor1, dims = 1:2, reduction = "pca", nfeatures = 20)
DimPlot(donor1, reduction = "pca") + NoLegend()
# visualize the expression of genes that drive a particular principal component across cells
# dims=1 plots genes contributing to PC1
# cells=500 shows the heatmap for 500 randomly selected cells
# balanced = TRUE → ensures the heatmap shows both high and low expression extremes evenly
DimHeatmap(donor1, dims = 1, cells = 500, balanced = TRUE)
# determine how many principal components (PCs) to retain for downstream analysis
ElbowPlot(donor1)
# Cluster The Cells
# Constructs a graph based on the PCs and clusters is done in PC space
donor1 <- FindNeighbors(donor1)
donor1 <- FindClusters(donor1, resolution = 0.25)
# Cluster The Cells
# Constructs a graph based on the PCs and clusters is done in PC space
donor1 <- FindNeighbors(donor1)
donor1 <- FindClusters(donor1, resolution = 0.25)
# # visualize clusters in 2D
donor1 <- RunUMAP(donor1)
# # visualize clusters in 2D
donor1 <- RunUMAP(donor1, dims=1:10)
DimPlot(donor1, reduction = "umap", label = TRUE)
# loading dataset (combined cellramger ouput for 3 donors)
lung.data <- ReadH5AD("data/combined_adata.h5ad")
library(SeuratDisk)
install.packages("SeuratDisk")
library(SeuratDisk)
BiocManager::install("zellkonverter")
# load necessary packages
library(dplyr)
library(Seurat)
library(patchwork)
library(zellkonverter)
# Set your working directory
setwd("C:\\scRNA_analysis_using_Seurat")
#checking if working directory is set correctly
getwd()
# loading dataset (combined cellramger ouput for 3 donors)
lung.data <- ReadH5AD("data/combined_adata.h5ad")
# loading dataset (combined cellramger ouput for 3 donors)
lung.data <- readH5AD("data/combined_adata.h5ad")
# check the number of genes and cells before any filtering
dim(lung.data)
# Initialize the Seurat object with the raw (non-normalized data).
lung <- as.Seurat(lung.data)
browseVignettes("DESeq2")
setwd("C:\\DESeq2_Practice")
getwd()
# Load count data (gene by sample)
# Source: https://github.com/QuangOngCM/LDM_RNAseq_ChIPseq_NSCLC/blob/main/data/RNA-seq_RawCounts.Rds
rna_counts <- readRDS("data/RNA-seq_RawCounts.Rds")
class(rna_counts)
class(rna_counts)
head(rna_counts)
View(rna_counts)
packageVersion("DESeq2")
# Load packages
library("DESeq2") # ‘1.46.0’
# Load count data (gene by sample)
rna_counts <- read.delim("path/to/raw_counts.tsv", header = TRUE, row.names = 1)
# Load count data (gene by sample)
rna_counts <- read.delim("data/raw_counts.tsv", header = TRUE, row.names = 1)
class(rna_counts)
head(rna_counts)
# Load count data (gene by sample)
# row.names = 1 → assumes the first column has gene IDs, which we want as row names.
# DESeq2 expected input is a matrix or data frame with rownames = gene IDs, columns = samples
rna_counts <- read.delim("data/raw_counts.tsv", header = TRUE)
head(rna_counts)
# Load count data (gene by sample)
# row.names = 1 → assumes the first column has gene IDs, which we want as row names.
# DESeq2 expected input is a matrix or data frame with rownames = gene IDs, columns = samples
rna_counts <- read.delim("data/raw_counts.tsv", header = TRUE, row.names = 1)
head(rna_counts)
View(rna_counts)
dim(rna_counts)
packageVersion("Bioconductor")
BiocManager::version()
# Load count data (gene by sample)
# row.names = 1 → assumes the first column has gene IDs, which we want as row names.
# DESeq2 expected input is a matrix or data frame with rownames = gene IDs, columns = samples
rawCounts  <- read.delim("data/raw_counts.tsv", header = TRUE, row.names = 1)
View(rna_counts)
dim(rawCounts)
View(rna_counts)
head(rawCounts)
sampleData <- read.delim("http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-experiment-design.tsv")
View(sampleData)
# Liad Metadata
sampleData <- read.delim("http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-experiment-design.tsv")
head(sampleData)
View(sampleData)
View(rawCounts)
# Load row count data
rawCounts <- read.delim("http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-raw-counts.tsv")
dim(rawCounts)
head(rawCounts)
# Load Metadata
sampleData <- read.delim("http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-experiment-design.tsv")
head(sampleData)
sampleData_v2 <- sampleData
colnames(rawCounts)
# Convert count data to a matrix of appropriate form that DEseq2 can read
geneID <- rawCounts$Gene.ID
sampleIndex <- grepl("SRR\\d+", colnames(rawCounts)) # grepl exclude columns Gene.Name and Gene.ID
rawCounts <- as.matrix(rawCounts[,sampleIndex])
rownames(rawCounts) <- geneID
head(rawCounts)
head(rawCounts, 2)
head(rawCounts, 1)
head(rawCounts)
head(rawCounts, 1)
head(rawCounts)
View(rawCounts)
View(rawCounts)
View(rawCounts)
head(rawCounts)
# Load Sample data (meta data on samples)
sampleData <- read.delim("http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-experiment-design.tsv")
head(sampleData)
# Convert sample variable mappings to an appropriate form that DESeq2 can read
rownames(sampleData) <- sampleData$Run
keep <- c("Sample.Characteristic.biopsy.site.", "Sample.Characteristic.individual.")
sampleData <- sampleData[,keep] # remove unnecessary columns
# ------------------------------------------------------- #
# Analyzing RNA-seq data with DESeq2
# Source: https://genviz.org/module-04-expression/0004/02/01/DifferentialExpression/
# ------------------------------------------------------- #
setwd("C:\\DESeq2_Practice")
getwd()
# Load packages
library("DESeq2") # ‘1.46.0’
# DESeq2 needs:
# 1. Raw counts (non-normalized)
# Type: integer counts (non-negative numbers)
# Rows: genes
# Columns: samples
# 2. Metadata (colData)
# Type: data frame
# Rows: samples (same order as in the count matrix)
# Columns: experimental variables, e.g.:
# - Condition (Tumor vs Normal)
# - Batch
# - Patient ID
# Load row count data
rawCounts <- read.delim("http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-raw-counts.tsv")
dim(rawCounts)
head(rawCounts)
# Convert count data to a matrix of appropriate form that DEseq2 can read
geneID <- rawCounts$Gene.ID
sampleIndex <- grepl("SRR\\d+", colnames(rawCounts)) # grepl exclude columns Gene.Name and Gene.ID
rawCounts <- as.matrix(rawCounts[,sampleIndex]) # Data frame also work, but only if all columns are numeric.
rownames(rawCounts) <- geneID # DESeq2 requires matrix or data frame with rownames = gene IDs, columns = samples
View(rawCounts)
head(rawCounts)
# Load Sample data (meta data on samples)
sampleData <- read.delim("http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-experiment-design.tsv")
head(sampleData)
# Convert sample variable mappings to an appropriate form that DESeq2 can read
rownames(sampleData) <- sampleData$Run
keep <- c("Sample.Characteristic.biopsy.site.", "Sample.Characteristic.individual.")
sampleData <- sampleData[,keep] # remove unnecessary columns
head(sampleData)
View(sampleData)
sampleData[sampleData$Sample.Characteristic.individual.=="AMC_2"]
colnames(sampleData) <- c("tissueType", "individualID")
head(sampleData)
sampleData[sampleData$individualID=="AMC_2"]
sampleData[sampleData$individualID=="AMC_2", ]
sampleData[sampleData$individualID=="AMC_3", ]
sampleData$individualID <- factor(sampleData$individualID)
head(sampleData)
rownames(sampleData)
len(rownames(sampleData))
length(rownames(sampleData))
length(uniique(rownames(sampleData)))
length(unique(rownames(sampleData)))
# DESeq2 requires that columns of rawCounts match rows of sampleData.
# Put the columns of the count data in the same order as rows names of the sample mapping, then make sure it worked
rawCounts <- rawCounts[,unique(rownames(sampleData))]
all(colnames(rawCounts) == rownames(sampleData)) # should return TRUE
# Load packages
library("DESeq2") # ‘1.46.0’
library(dplyr)
# rename tissue types
sampleData$tissueType <- recode(
sampleData$tissueType,
"normal" = "normal-looking surrounding colonic epithelium",
"primary tumor" = "primary colorectal cancer",
"colorectal cancer metastatic in the liver" = "metastatic colorectal cancer to the liver"
)
head(sampleData)
View(sampleData)
View(sampleData)
# Converts the tissueType column from character to a factor and
# Change order such that control samples come first because,
# DESeq2 (and R in general) uses the first level of a factor as the reference/control in comparisons.
sampleData$tissueType <- factor(
sampleData$tissueType,
levels = c(
"normal-looking surrounding colonic epithelium",
"primary colorectal cancer",
"metastatic colorectal cancer to the liver"
)
)
head(sampleData)
View(sampleData)
# ------------------------------------------------------- #
# Analyzing RNA-seq data with DESeq2
# Source: https://genviz.org/module-04-expression/0004/02/01/DifferentialExpression/
# ------------------------------------------------------- #
setwd("C:\\DESeq2_Practice")
getwd()
# Load packages
library("DESeq2") # ‘1.46.0’
library(dplyr)
# DESeq2 needs:
# 1. Raw counts (non-normalized)
# Type: integer counts (non-negative numbers)
# Rows: genes
# Columns: samples
# 2. Metadata (colData)
# Type: data frame
# Rows: samples (same order as in the count matrix)
# Columns: experimental variables, e.g.:
# - Condition (Tumor vs Normal)
# - Batch
# - Patient ID
# Load row count data
rawCounts <- read.delim("http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-raw-counts.tsv")
dim(rawCounts)
head(rawCounts)
# Convert count data to a matrix of appropriate form that DEseq2 can read
geneID <- rawCounts$Gene.ID
sampleIndex <- grepl("SRR\\d+", colnames(rawCounts)) # grepl exclude columns Gene.Name and Gene.ID
rawCounts <- as.matrix(rawCounts[,sampleIndex]) # Data frame also work, but only if all columns are numeric.
rownames(rawCounts) <- geneID # DESeq2 requires matrix or data frame with rownames = gene IDs, columns = samples
View(rawCounts)
head(rawCounts)
# Load Sample data (meta data on samples)
sampleData <- read.delim("http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-experiment-design.tsv")
head(sampleData)
# Convert sample variable mappings to an appropriate form that DESeq2 can read
rownames(sampleData) <- sampleData$Run
keep <- c("Sample.Characteristic.biopsy.site.", "Sample.Characteristic.individual.")
sampleData <- sampleData[,keep] # remove unnecessary columns
colnames(sampleData) <- c("tissueType", "individualID")
sampleData$individualID <- factor(sampleData$individualID)
head(sampleData)
# DESeq2 requires that columns of rawCounts match rows of sampleData.
# Put the columns of the count data in the same order as rows names of the sample mapping, then make sure it worked
rawCounts <- rawCounts[,unique(rownames(sampleData))]
all(colnames(rawCounts) == rownames(sampleData)) # should return TRUE
# rename tissue types
sampleData$tissueType <- recode( # dplyr
sampleData$tissueType,
"normal" = "normal-looking surrounding colonic epithelium",
"primary tumor" = "primary colorectal cancer",
"colorectal cancer metastatic in the liver" = "metastatic colorectal cancer to the liver"
)
head(sampleData)
# Convert tissueType from character to a factor
sampleData$tissueType <- factor(sampleData$tissueType)
head(sampleData)
levels(sampleData$tissueType)
# Change levels order such that control samples come first because,
# DESeq2 (and R in general) uses the first level of a factor as the reference/control in comparisons.
levels(sampleData$tissueType) <- c(
"normal-looking surrounding colonic epithelium",
"primary colorectal cancer",
"metastatic colorectal cancer to the liver"
)
levels(sampleData$tissueType)
# Create the DEseq2DataSet object
deseq2Data <- DESeqDataSetFromMatrix(countData=rawCounts, colData=sampleData, design= ~ individualID + tissueType)
deseq2Data
# to access count data
counts(deseq2Data)
# to access count data
# counts(deseq2Data)
rowSums(counts(deseq2Data)) > 5
rowSums(counts(deseq2Data)) > 5 # TRUE if the gene's total count > 5, FALSE otherwise
deseq2Data[rowSums(counts(deseq2Data)) > 5, ] # subsets the DESeqDataSet rows (genes) where the logical vector is TRUE
dim(deseq2Data)
dim(deseq2Data)
dim(deseq2Data[rowSums(counts(deseq2Data)) > 5, ])
# Filter out genes with total count less than 5
deseq2Data <- deseq2Data[rowSums(counts(deseq2Data)) > 5, ]
setwd("C:\\DESeq2_Practice")
getwd()
# Load packages
library("DESeq2") # ‘1.46.0’
library(dplyr)
# Load row count data
rawCounts <- read.delim("http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-raw-counts.tsv")
dim(rawCounts)
head(rawCounts)
# Convert count data to a matrix of appropriate form that DEseq2 can read
geneID <- rawCounts$Gene.ID
sampleIndex <- grepl("SRR\\d+", colnames(rawCounts)) # grepl exclude columns Gene.Name and Gene.ID
rawCounts <- as.matrix(rawCounts[,sampleIndex]) # Data frame also work, but only if all columns are numeric.
rownames(rawCounts) <- geneID # DESeq2 requires matrix or data frame with rownames = gene IDs, columns = samples
View(rawCounts)
head(rawCounts)
# Load Sample data (meta data on samples)
sampleData <- read.delim("http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-experiment-design.tsv")
head(sampleData)
# Convert sample variable mappings to an appropriate form that DESeq2 can read
rownames(sampleData) <- sampleData$Run
keep <- c("Sample.Characteristic.biopsy.site.", "Sample.Characteristic.individual.")
sampleData <- sampleData[,keep] # remove unnecessary columns
colnames(sampleData) <- c("tissueType", "individualID")
sampleData$individualID <- factor(sampleData$individualID)
head(sampleData)
# Put the columns of the count data in the same order as rows names of the sample mapping, then make sure it worked
rawCounts <- rawCounts[,unique(rownames(sampleData))]
all(colnames(rawCounts) == rownames(sampleData)) # should return TRUE
# rename tissue types
sampleData$tissueType <- recode( # dplyr
sampleData$tissueType,
"normal" = "normal-looking surrounding colonic epithelium",
"primary tumor" = "primary colorectal cancer",
"colorectal cancer metastatic in the liver" = "metastatic colorectal cancer to the liver"
)
head(sampleData)
# Convert tissueType from character to a factor
sampleData$tissueType <- factor(sampleData$tissueType)
levels(sampleData$tissueType)
# Change levels order such that control samples come first
levels(sampleData$tissueType) <- c(
"normal-looking surrounding colonic epithelium",
"primary colorectal cancer",
"metastatic colorectal cancer to the liver"
)
levels(sampleData$tissueType)
# Create the DEseq2DataSet object
deseq2Data <- DESeqDataSetFromMatrix(countData=rawCounts, colData=sampleData, design= ~ individualID + tissueType)
deseq2Data
dim(deseq2Data)
dim(deseq2Data[rowSums(counts(deseq2Data)) > 5, ])
dim(deseq2Data)
# Filter out genes with total count less than 5
deseq2Data <- deseq2Data[rowSums(counts(deseq2Data)) > 5, ]
dim(deseq2Data)
deseq2Data <- DESeq(deseq2Data)
results(deseq2Data)
test <- results(deseq2Data)
View(test)
results(deseq2Data)
setwd("C:\\DESeq2_Practice")
getwd()
# Load packages
library("DESeq2") # ‘1.46.0’
library(dplyr)
setwd("C:\\DESeq2_Practice")
getwd()
# Load packages
library("DESeq2") # ‘1.46.0’
library(dplyr)
# Load row count data
rawCounts <- read.delim("http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-raw-counts.tsv")
dim(rawCounts)
head(rawCounts)
# Convert count data to a matrix of appropriate form that DEseq2 can read
geneID <- rawCounts$Gene.ID
sampleIndex <- grepl("SRR\\d+", colnames(rawCounts)) # grepl exclude columns Gene.Name and Gene.ID
rawCounts <- as.matrix(rawCounts[,sampleIndex]) # Data frame also work, but only if all columns are numeric.
rownames(rawCounts) <- geneID # DESeq2 requires matrix or data frame with rownames = gene IDs, columns = samples
View(rawCounts)
head(rawCounts)
# Load Sample data (meta data on samples)
sampleData <- read.delim("http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-experiment-design.tsv")
head(sampleData)
# Convert sample variable mappings to an appropriate form that DESeq2 can read
rownames(sampleData) <- sampleData$Run
keep <- c("Sample.Characteristic.biopsy.site.", "Sample.Characteristic.individual.")
sampleData <- sampleData[,keep] # remove unnecessary columns
colnames(sampleData) <- c("tissueType", "individualID")
sampleData$individualID <- factor(sampleData$individualID)
head(sampleData)
# Put the columns of the count data in the same order as rows names of the sample mapping, then make sure it worked
rawCounts <- rawCounts[,unique(rownames(sampleData))]
all(colnames(rawCounts) == rownames(sampleData)) # should return TRUE
# rename tissue types
sampleData$tissueType <- recode( # dplyr
sampleData$tissueType,
"normal" = "normal-looking surrounding colonic epithelium",
"primary tumor" = "primary colorectal cancer",
"colorectal cancer metastatic in the liver" = "metastatic colorectal cancer to the liver"
)
head(sampleData)
# Convert tissueType from character to a factor
sampleData$tissueType <- factor(sampleData$tissueType)
levels(sampleData$tissueType)
# Change levels order such that control samples come first
levels(sampleData$tissueType) <- c(
"normal-looking surrounding colonic epithelium",
"primary colorectal cancer",
"metastatic colorectal cancer to the liver"
)
levels(sampleData$tissueType)
# Create the DEseq2DataSet object
deseq2Data <- DESeqDataSetFromMatrix(countData=rawCounts, colData=sampleData, design= ~ individualID + tissueType)
deseq2Data
dim(deseq2Data)
dim(deseq2Data[rowSums(counts(deseq2Data)) > 5, ])
# Filter out genes with total count less than 5
deseq2Data <- deseq2Data[rowSums(counts(deseq2Data)) > 5, ]
# run DEseq() on our DESeq2 data set object
deseq2Data <- DESeq(deseq2Data)
results(deseq2Data)
deseq2Results <- results(deseq2Data, contrast=c("tissueType", "primary colorectal cancer", "normal-looking surrounding colonic epithelium"))
summary(deseq2Results)
setwd("C:\\DESeq2_Practice")
getwd()
